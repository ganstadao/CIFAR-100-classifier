# CIFAR-10 分类器

这是一个基于深度学习的 CIFAR-10 图像分类器项目。该项目使用了 ResNet（残差网络）架构，旨在通过训练模型对 CIFAR-100 数据集中的图像进行分类。项目包括数据预处理、模型定义、训练、评估以及可视化模块，具有较好的可扩展性和结构性。

## 项目结构

```
CIFAR-100-classifier/
│
├── data/                    # 数据集文件夹（CIFAR-100）
├── model/                   # 存放模型定义和辅助函数
│   ├── __init__.py
│   ├── resnet.py            # ResNet模型定义
│   └── utils.py             # 可视化和评估函数
├── scripts/                 # 主要的脚本文件
│   ├── train.py             # 训练脚本
│   ├── evaluate.py          # 评估脚本
│   └── visualize.py         # 可视化脚本
└── results/                 # 存放训练结果和保存的模型文件
    └── resnet_cifar100.pth  # 保存训练好的模型
```

## 环境要求

- Python 3.7 或更高版本
- PyTorch 1.7 或更高版本
- torchvision 0.8 或更高版本
- matplotlib
- seaborn
- numpy
- scikit-learn

可以使用以下命令安装依赖：

```bash
pip install torch torchvision matplotlib seaborn numpy scikit-learn
```

## 数据集

该项目使用的是 [CIFAR-100 数据集](https://www.cs.toronto.edu/~kriz/cifar.html)，该数据集包含 100 个类，每个类有 600 张 32x32 的彩色图像。数据集已经通过 `torchvision.datasets.CIFAR100` 自动下载并加载。

## 使用说明

### 1. 训练模型

使用 `train.py` 脚本进行模型训练。训练过程中，模型将自动下载 CIFAR-100 数据集并进行训练。训练结束后，模型将保存在 `results/` 文件夹中。

运行训练脚本：

```bash
python scripts/resnet_train.py
```

训练过程中，损失值会在每个 epoch 打印，并且每 10 个 epoch 会生成一次训练损失曲线的图像。

### 2. 评估模型

使用 `evaluate.py` 脚本评估训练好的模型，评估过程中会生成混淆矩阵热力图，用于展示模型在各个类别上的预测情况。

运行评估脚本：

```bash
python scripts/evaluate.py
```

该脚本会加载训练好的模型并计算测试集上的准确度，同时展示混淆矩阵热力图。

### 3. 可视化预测结果

使用 `visualize.py` 脚本来随机选择图像，并显示模型的预测结果和真实标签。

运行可视化脚本：

```bash
python scripts/visualize.py
```

该脚本会随机显示测试集中的一张图像，并将其预测标签与真实标签进行对比。

## 模型架构

该项目使用了 **ResNet**（残差网络）架构。ResNet 在传统卷积神经网络的基础上引入了残差连接，使得模型在深层网络中训练时能有效避免梯度消失问题。ResNet 被广泛应用于图像分类任务中，并在多个计算机视觉挑战中取得了卓越的表现。

在本项目中，使用的是 ResNet-18（包含 18 层）架构。模型的具体结构如下：

- 输入层：32x32 彩色图像
- 卷积层：64 个过滤器，大小 3x3
- 残差块：包含 4 层残差块
- 全局平均池化层
- 全连接层：输出 100 个类别（CIFAR-100 的类别数量）

## 训练参数

- **优化器**: AdamW（带权重衰减的 Adam 优化器）
- **学习率**: 0.001
- **批次大小**: 128
- **训练轮数**: 100
- **学习率衰减**: 每 20 个 epoch 衰减一次

## 可视化

- **训练损失曲线**: 每 10 个 epoch 打印并保存一次训练损失曲线，帮助跟踪模型的训练过程。
- **混淆矩阵热力图**: 显示模型在不同类别上的预测情况，帮助理解模型的误分类情况。
- **随机预测结果**: 随机选择一张图像，展示模型预测标签与真实标签。

## 结果示例

训练完成后，您将能够看到训练损失曲线和混淆矩阵热力图，这些图像有助于评估模型的性能。

